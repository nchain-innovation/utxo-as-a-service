@startuml
title UTXO as a Service P2P message handling
top to bottom direction
'right to left direction

actor peer_node as pn

package "Database" {
    database Mempool
    database Txs
    database UTXO
    database Blocks
}

package "UaaS Rust" {

    queue BlockQueue

    pn -down-> (On Transaction) :tx

    (On Transaction) .down.> (Mempool): add_tx

    pn -down-> (On Block) :block

    (On Block) .down.> (Mempool): remove_tx
    (On Block) .down.> (Txs): add_tx
    (On Block) .down.> (UTXO): update_outpoints

    (On Block) .down.> (Blocks): add_blockheader

    (On Block) <.right.> BlockQueue: push/pop

}


@enduml